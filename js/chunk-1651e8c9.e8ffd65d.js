(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1651e8c9"],{"148b":function(t,e,i){"use strict";var a=i("7f6a"),s=i.n(a);s.a},"2fc4":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"order-manage container"},[i("div",{staticClass:"row mt-3"},[i("div",{staticClass:"mr-auto"},[i("Pagination",{attrs:{"current-page":t.page,"total-page":t.totalPage},on:{"change-page":t.changePage}})],1),i("button",{staticClass:"btn btn-primary btn-add",attrs:{type:"button"},on:{click:function(e){return t.toggleModal("new")}}},[i("font-awesome-icon",{staticClass:"nav-icon",attrs:{icon:["fas","plus-square"]}}),t._v(" 新增新聞 ")],1)]),i("div",{staticClass:"row mt-3"},[i("table",{staticClass:"table table-bordered"},[t._m(0),i("tbody",t._l(t.filtedNews,(function(e,a){return i("tr",{key:"news_"+a},[i("td",{staticClass:"align-middle col-index",attrs:{scope:"row"}},[t._v(t._s(t.paged*(t.page-1)+a+1))]),i("td",{staticClass:"align-middle col-img"},[t._v(" "+t._s(e.data.title)+" ")]),i("td",{staticClass:"align-middle col-del"},[i("div",{staticClass:"btn-group",attrs:{role:"group"}},[i("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button"},on:{click:function(e){return t.toggleModal(a)}}},[i("font-awesome-icon",{staticClass:"nav-icon",attrs:{icon:["fas","edit"]}}),t._v(" 編輯 ")],1),i("button",{staticClass:"btn btn-outline-warning",attrs:{type:"button"},on:{click:function(i){return t.triggerDelete(e.id)}}},[i("font-awesome-icon",{staticClass:"nav-icon",attrs:{icon:["fas","trash-alt"]}}),t._v(" 刪除 ")],1)])])])})),0)])]),i("div",{staticClass:"modal fade bd-example-modal-xl",attrs:{tabindex:"-1",role:"dialog","aria-labelledby":"newsModal","aria-hidden":"true",id:"newsModal"}},[i("div",{staticClass:"modal-dialog modal-xl"},[i("div",{staticClass:"modal-content"},[i("div",{staticClass:"modal-body"},[i("div",{staticClass:"container-fluid"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[i("div",{staticClass:"form-group"},[i("label",{attrs:{for:"title"}},[t._v("新聞標題")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.editingNews.title,expression:"editingNews.title"}],staticClass:"form-control",attrs:{type:"text",name:"title",id:"title"},domProps:{value:t.editingNews.title},on:{input:function(e){e.target.composing||t.$set(t.editingNews,"title",e.target.value)}}})]),i("div",{staticClass:"form-row mt-3"},[i("div",{staticClass:"col"},[i("label",{attrs:{for:"content"}},[t._v("新聞內容")]),i("vue-editor",{attrs:{customModules:t.customModulesForEditor,editorOptions:t.editorSettings},model:{value:t.editingNews.content,callback:function(e){t.$set(t.editingNews,"content",e)},expression:"editingNews.content"}})],1)])])])])]),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("取消")]),i("button",{directives:[{name:"show",rawName:"v-show",value:!t.isCreating,expression:"!isCreating"}],staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.updateNews(t.editingId)}}},[t._v(" 儲存修改 ")]),i("button",{directives:[{name:"show",rawName:"v-show",value:t.isCreating,expression:"isCreating"}],staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.addNew}},[t._v(" 新增新聞 ")])])])])])])},s=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("th",{staticClass:"col-index"},[t._v("編號")]),i("th",{staticClass:"col-img"},[t._v("新聞標題")]),i("th",{staticClass:"col-del"},[t._v("編輯")])])])}],n=i("3761"),o=n["a"],d=(i("148b"),i("2877")),l=Object(d["a"])(o,a,s,!1,null,"02c11690",null);e["default"]=l.exports},3761:function(t,e,i){"use strict";(function(t){i("4160"),i("fb6a"),i("159b");var a=i("1799"),s=i("b22f"),n=i("f318"),o=i.n(n);e["a"]={components:{Pagination:a["a"]},props:{token:String,tokenReady:Boolean},data:function(){return{page:1,paged:15,totalPage:1,news:[],customModulesForEditor:[{alias:"imageResize",module:o.a}],editorSettings:{modules:{imageResize:{}}},editingId:"",editingNews:{},isCreating:!0}},methods:{getNews:function(){var t=this,e=this.$loading.show();s["b"].orderBy("created","desc").get().then((function(i){e.hide(),i.forEach((function(e){t.news.push({id:e.id,data:e.data()})})),t.totalPage=Math.ceil(t.news.length/t.paged)}))},addNew:function(){var e=this,i=this.$loading.show();this.editingNews.created=Math.floor(Date.now()/1e3),this.editingNews.updated=Math.floor(Date.now()/1e3),s["b"].add(this.editingNews).then((function(){i.hide(),t("#newsModal").modal("hide"),e.news=[],e.getNews()}))},updateNews:function(e){var i=this,a=this.$loading.show();this.editingNews.updated=Math.floor(Date.now()/1e3),s["b"].doc(e).update(this.editingNews).then((function(){a.hide(),t("#newsModal").modal("hide"),i.news=[],i.getNews()}))},deleteNews:function(t){var e=this,i=this.$loading.show();s["b"].doc(t).delete().then((function(){i.hide(),e.news=[],e.getNews()}))},triggerDelete:function(t){var e=this;this.$swal({icon:"warning",text:"確認刪除此篇新聞嗎？",showCancelButton:!0,reverseButtons:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then((function(i){var a=i.isConfirmed;return!!a&&e.deleteNews(t)}))},toggleModal:function(e){"new"===e?(this.isCreating=!0,this.editingNews={title:"",content:""},t("#newsModal").modal("show")):(this.isCreating=!1,this.editingId=this.news[e].id,this.editingNews=this._.cloneDeep(this.news[e].data),t("#newsModal").modal("show"))},changePage:function(t){this.page=t}},created:function(){this.tokenReady&&this.getNews()},watch:{tokenReady:function(t){t&&this.getNews()}},computed:{filtedNews:function(){var t=(this.page-1)*this.paged,e=this.page*this.paged;return this.news.slice(t,e)}}}}).call(this,i("1157"))},"7f6a":function(t,e,i){},fb6a:function(t,e,i){"use strict";var a=i("23e7"),s=i("861d"),n=i("e8b5"),o=i("23cb"),d=i("50c4"),l=i("fc6a"),r=i("8418"),c=i("b622"),u=i("1dde"),g=i("ae40"),w=u("slice"),h=g("slice",{ACCESSORS:!0,0:0,1:2}),f=c("species"),v=[].slice,m=Math.max;a({target:"Array",proto:!0,forced:!w||!h},{slice:function(t,e){var i,a,c,u=l(this),g=d(u.length),w=o(t,g),h=o(void 0===e?g:e,g);if(n(u)&&(i=u.constructor,"function"!=typeof i||i!==Array&&!n(i.prototype)?s(i)&&(i=i[f],null===i&&(i=void 0)):i=void 0,i===Array||void 0===i))return v.call(u,w,h);for(a=new(void 0===i?Array:i)(m(h-w,0)),c=0;w<h;w++,c++)w in u&&r(a,c,u[w]);return a.length=c,a}})}}]);
//# sourceMappingURL=chunk-1651e8c9.e8ffd65d.js.map